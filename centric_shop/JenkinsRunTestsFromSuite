pipeline {
  agent any

  stages {
    stage('Divide Test Cases') {
      steps {
        dir('centric_shop') {
        script {
          // Run the Ruby script using cuke-slicer
          sh 'ruby divide_test_cases.rb'
        }
       }
     }
   }

    stage('Run Test Cases') {
      steps {
        dir('centric_shop') {
        script {
          // Retrieve the list of suites generated by cuke-slicer
          def suites = sh(returnStdout: true, script: 'ls -1 suite_*.feature').trim().split('\n')
          println "${suites}"

          for (int i = 0; i < suites.size(); i++) {
            def suite = suites[i]
            // Run each suite of test cases on the Jenkins slave
            sh "cucumber ${suite}"
          }
        }
      }
    }}

    // Add more stages for additional pipeline steps
    // ...
  }
}
